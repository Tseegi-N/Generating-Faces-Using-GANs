# Uncovering Biases in Facial Recognition Systems

## Overview
*This is a final project for MTH 354 : Mathematics Behind Deep Learning*
This project focuses on **uncovering biases in facial recognition systems** by utilizing **Generative Adversarial Networks (GANs)** to generate unbiased synthetic images, ultimately aimed at debiasing facial classification training.

Since the inception of biometric and facial recognition technologies, biases in gender and race have been well-documented. For example, a 2018 study titled *"Gender Shades"* by Joy Buolamwini and Timnit Gebru revealed:
- Error rates for light-skinned men were 0.8%, compared to 34.7% for darker-skinned women.
- Classifiers performed better on male faces than female faces (8.1%–20.6% difference in error rate).
- Classifiers performed better on lighter faces than darker faces (11.8%–19.2% difference in error rate).

Inspired by this research, the goal of this project is to create synthetic face images using GANs trained on a diverse dataset. This enables the generation of data that better represents a wide range of demographics and can be used to mitigate biases in facial recognition systems.

## Dataset
We utilized the **Face Attribute Dataset for Balanced Race, Gender, and Age for Bias Measurement and Mitigation** by Kimmo Karkkainen and Jungseock Joo. This dataset, available on Kaggle, contains:
- **108,501 images**
- Labeled attributes for **7 race groups**: White, Black, Indian, East Asian, Southeast Asian, Middle Eastern, and Latino
- Data collected from the YFCC-100M Flickr dataset, offering diverse representations of pose, age, hairstyle, and background

## Methodology
### Generative Adversarial Networks (GANs)
GANs consist of two neural networks:
- **Generator**: Creates synthetic images from random noise.
- **Discriminator**: Distinguishes between real images and synthetic images generated by the Generator.

The two networks are trained in a competitive manner, with the goal of the Generator producing data indistinguishable from real data. This process is defined by a minimax game function:

```math
\min_G \max_D \mathbb{E}_{x \sim p_{data}(x)}[\log D(x)] + \mathbb{E}_{z \sim p_z(z)}[\log(1 - D(G(z)))]
```

#### Implementation
We employed **DCGAN (Deep Convolutional GAN)** for this project, which uses fully convolutional layers for better performance.

- **Generator**:
  - **Input**: Random noise vector (size = 100).
  - **Architecture**: Dense layers, transposed convolutions, batch normalization, ReLU activations, and Tanh for the output layer.
  - **Output**: Synthetic face image (128x128x3).

- **Discriminator**:
  - **Input**: Real or synthetic image.
  - **Architecture**: Convolutional layers, batch normalization, Leaky ReLU activations, and a dense Sigmoid output layer.
  - **Output**: Probability of the image being real or synthetic.

### Training
- **Dataset**: Balanced across race, gender, and age groups.
- **Training Setup**: Conducted on limited computational resources, with one epoch taking approximately 5 minutes.
- **Challenges**: Losses for both Generator and Discriminator remained around 1 after 5 epochs, indicating suboptimal training likely due to hardware constraints.

## Results and Learnings
While the results fell short of expectations due to limited computational capacity, the project provided invaluable experience in:
- Implementing and training GANs
- Understanding biases in AI systems
- Working with diverse datasets

This project display the potential behind debiasing facial recognition systems using synthetic data.

## Conclusion
This project highlights the potential of GANs to mitigate biases in facial recognition systems by generating more inclusive datasets. Although challenges remain, the knowledge gained through this endeavor will inform future research and development efforts.

## References
- Buolamwini, J., & Gebru, T. (2018). *Gender Shades: Intersectional Accuracy Disparities in Commercial Gender Classification.*
- Karkkainen, K., & Joo, J. (2021). *Face Attribute Dataset for Balanced Race, Gender, and Age for Bias Measurement and Mitigation.*
- FairFace Dataset - *https://www.kaggle.com/datasets/aibloy/fairface/data* 
- Huang, H., Yu, P. S., & Wang, C. (2018). *An introduction to image synthesis with generative adversarial nets.* arXiv preprint arXiv:1803.04469.
- Github project that I took inspiration from - *https://github.com/varundixit4/Generating-Fake-Faces-Using-GAN*
- Explaination of upsampling and transpose convolution - *https://machinelearningmastery.com/upsampling-and-transpose-convolution-layers-for-generative-adversarial-networks/* 
- Xu, D., Yuan, S., Zhang, L., & Wu, X. (2018, December). *Fairgan: Fairness-aware generative adversarial networks. In 2018 IEEE international conference on big data (big data) (pp. 570-575).* IEEE.
